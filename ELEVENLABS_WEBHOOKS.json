{
  "agent_name": "CrownDesk AI Receptionist",
  "description": "Complete webhook configuration for ElevenLabs conversational AI agent",
  "base_urls": {
    "backend": "https://cdapi.xaltrax.com/api",
    "ai_service": "https://ai-service-sparkling-brook-7912.fly.dev"
  },
  "authentication": {
    "note": "All webhooks require Authorization header with Bearer token",
    "header_name": "Authorization",
    "header_value": "Bearer ${BACKEND_API_KEY}",
    "additional_headers": [
      {
        "name": "x-tenant-id",
        "value": "${TENANT_ID}",
        "description": "Tenant identifier for multi-tenant operations"
      }
    ]
  },
  "webhooks": [
    {
      "type": "webhook",
      "name": "search_patients",
      "description": "Search for patients by name, phone, or email. Use this when caller mentions their name or you need to find a patient.",
      "api_schema": {
        "url": "https://cdapi.xaltrax.com/api/patients/search",
        "method": "GET",
        "path_params_schema": [],
        "query_params_schema": [
          {
            "name": "q",
            "type": "string",
            "required": true,
            "description": "Search query - patient name, email, or phone number (minimum 2 characters)"
          }
        ],
        "request_body_schema": null,
        "request_headers": [
          {
            "name": "Authorization",
            "value": "Bearer ${BACKEND_API_KEY}"
          },
          {
            "name": "x-tenant-id",
            "value": "${TENANT_ID}"
          }
        ],
        "auth_connection": null
      },
      "response_timeout_secs": 10,
      "dynamic_variables": {
        "dynamic_variable_placeholders": {}
      },
      "assignments": [],
      "disable_interruptions": false,
      "force_pre_tool_speech": "auto",
      "tool_call_sound": null,
      "tool_call_sound_behavior": "auto",
      "execution_mode": "immediate"
    },
    {
      "type": "webhook",
      "name": "get_patient_details",
      "description": "Get detailed patient information including appointments, insurance, and treatment plans. Use after finding patient ID.",
      "api_schema": {
        "url": "https://cdapi.xaltrax.com/api/patients/{patient_id}",
        "method": "GET",
        "path_params_schema": [
          {
            "name": "patient_id",
            "type": "string",
            "required": true,
            "description": "Patient UUID from search results"
          }
        ],
        "query_params_schema": [],
        "request_body_schema": null,
        "request_headers": [
          {
            "name": "Authorization",
            "value": "Bearer ${BACKEND_API_KEY}"
          },
          {
            "name": "x-tenant-id",
            "value": "${TENANT_ID}"
          }
        ],
        "auth_connection": null
      },
      "response_timeout_secs": 10,
      "dynamic_variables": {
        "dynamic_variable_placeholders": {}
      },
      "assignments": [],
      "disable_interruptions": false,
      "force_pre_tool_speech": "auto",
      "tool_call_sound": null,
      "tool_call_sound_behavior": "auto",
      "execution_mode": "immediate"
    },
    {
      "type": "webhook",
      "name": "get_available_slots",
      "description": "Check available appointment time slots for a specific provider and date. Use when scheduling appointments.",
      "api_schema": {
        "url": "https://cdapi.xaltrax.com/api/appointments/slots/{provider}/{date}",
        "method": "GET",
        "path_params_schema": [
          {
            "name": "provider",
            "type": "string",
            "required": true,
            "description": "Provider name (e.g., 'Dr. Smith') or 'any' for any available provider"
          },
          {
            "name": "date",
            "type": "string",
            "required": true,
            "description": "Date in YYYY-MM-DD format"
          }
        ],
        "query_params_schema": [
          {
            "name": "duration",
            "type": "number",
            "required": false,
            "description": "Appointment duration in minutes (default 30)"
          }
        ],
        "request_body_schema": null,
        "request_headers": [
          {
            "name": "Authorization",
            "value": "Bearer ${BACKEND_API_KEY}"
          },
          {
            "name": "x-tenant-id",
            "value": "${TENANT_ID}"
          }
        ],
        "auth_connection": null
      },
      "response_timeout_secs": 10,
      "dynamic_variables": {
        "dynamic_variable_placeholders": {}
      },
      "assignments": [],
      "disable_interruptions": false,
      "force_pre_tool_speech": "Let me check available times for you.",
      "tool_call_sound": null,
      "tool_call_sound_behavior": "auto",
      "execution_mode": "immediate"
    },
    {
      "type": "webhook",
      "name": "create_appointment",
      "description": "Book a new appointment for a patient. Use after confirming patient details, date, time, and appointment type.",
      "api_schema": {
        "url": "https://cdapi.xaltrax.com/api/appointments",
        "method": "POST",
        "path_params_schema": [],
        "query_params_schema": [],
        "request_body_schema": {
          "type": "object",
          "properties": {
            "patientId": {
              "type": "string",
              "description": "Patient UUID"
            },
            "providerId": {
              "type": "string",
              "description": "Provider UUID (optional, can be null for 'any provider')"
            },
            "operatoryId": {
              "type": "string",
              "description": "Operatory UUID (optional)"
            },
            "startTime": {
              "type": "string",
              "description": "ISO 8601 datetime string (e.g., 2026-01-25T09:00:00Z)"
            },
            "endTime": {
              "type": "string",
              "description": "ISO 8601 datetime string (e.g., 2026-01-25T09:30:00Z)"
            },
            "appointmentType": {
              "type": "string",
              "enum": ["new_patient", "recall", "treatment", "emergency", "consultation", "follow_up", "cleaning", "exam", "crown", "filling", "extraction", "root_canal"],
              "description": "Type of appointment"
            },
            "status": {
              "type": "string",
              "enum": ["scheduled", "confirmed"],
              "description": "Initial status (use 'scheduled')"
            },
            "notes": {
              "type": "string",
              "description": "Additional notes or patient concerns"
            },
            "reason": {
              "type": "string",
              "description": "Reason for visit"
            }
          },
          "required": ["patientId", "startTime", "endTime", "appointmentType"]
        },
        "request_headers": [
          {
            "name": "Authorization",
            "value": "Bearer ${BACKEND_API_KEY}"
          },
          {
            "name": "x-tenant-id",
            "value": "${TENANT_ID}"
          },
          {
            "name": "Content-Type",
            "value": "application/json"
          }
        ],
        "auth_connection": null
      },
      "response_timeout_secs": 15,
      "dynamic_variables": {
        "dynamic_variable_placeholders": {}
      },
      "assignments": [],
      "disable_interruptions": true,
      "force_pre_tool_speech": "Perfect! I'm booking that appointment for you now.",
      "tool_call_sound": null,
      "tool_call_sound_behavior": "auto",
      "execution_mode": "immediate"
    },
    {
      "type": "webhook",
      "name": "confirm_appointment",
      "description": "Confirm an existing appointment and optionally send confirmation notification.",
      "api_schema": {
        "url": "https://cdapi.xaltrax.com/api/appointments/{appointment_id}/confirm",
        "method": "POST",
        "path_params_schema": [
          {
            "name": "appointment_id",
            "type": "string",
            "required": true,
            "description": "Appointment UUID"
          }
        ],
        "query_params_schema": [],
        "request_body_schema": null,
        "request_headers": [
          {
            "name": "Authorization",
            "value": "Bearer ${BACKEND_API_KEY}"
          },
          {
            "name": "x-tenant-id",
            "value": "${TENANT_ID}"
          }
        ],
        "auth_connection": null
      },
      "response_timeout_secs": 10,
      "dynamic_variables": {
        "dynamic_variable_placeholders": {}
      },
      "assignments": [],
      "disable_interruptions": false,
      "force_pre_tool_speech": "auto",
      "tool_call_sound": null,
      "tool_call_sound_behavior": "auto",
      "execution_mode": "immediate"
    },
    {
      "type": "webhook",
      "name": "update_appointment_status",
      "description": "Update appointment status (reschedule, cancel, no-show, etc.)",
      "api_schema": {
        "url": "https://cdapi.xaltrax.com/api/appointments/{appointment_id}/status",
        "method": "PATCH",
        "path_params_schema": [
          {
            "name": "appointment_id",
            "type": "string",
            "required": true,
            "description": "Appointment UUID"
          }
        ],
        "query_params_schema": [],
        "request_body_schema": {
          "type": "object",
          "properties": {
            "status": {
              "type": "string",
              "enum": ["scheduled", "confirmed", "checked_in", "in_progress", "completed", "cancelled", "no_show"],
              "description": "New appointment status"
            }
          },
          "required": ["status"]
        },
        "request_headers": [
          {
            "name": "Authorization",
            "value": "Bearer ${BACKEND_API_KEY}"
          },
          {
            "name": "x-tenant-id",
            "value": "${TENANT_ID}"
          },
          {
            "name": "Content-Type",
            "value": "application/json"
          }
        ],
        "auth_connection": null
      },
      "response_timeout_secs": 10,
      "dynamic_variables": {
        "dynamic_variable_placeholders": {}
      },
      "assignments": [],
      "disable_interruptions": false,
      "force_pre_tool_speech": "auto",
      "tool_call_sound": null,
      "tool_call_sound_behavior": "auto",
      "execution_mode": "immediate"
    },
    {
      "type": "webhook",
      "name": "get_patient_appointments",
      "description": "Get all appointments for a specific patient. Use to check existing appointments before scheduling.",
      "api_schema": {
        "url": "https://cdapi.xaltrax.com/api/patients/{patient_id}/appointments",
        "method": "GET",
        "path_params_schema": [
          {
            "name": "patient_id",
            "type": "string",
            "required": true,
            "description": "Patient UUID"
          }
        ],
        "query_params_schema": [
          {
            "name": "status",
            "type": "string",
            "required": false,
            "description": "Filter by status (scheduled, confirmed, completed, cancelled)"
          },
          {
            "name": "limit",
            "type": "number",
            "required": false,
            "description": "Maximum number of appointments to return (default 10)"
          }
        ],
        "request_body_schema": null,
        "request_headers": [
          {
            "name": "Authorization",
            "value": "Bearer ${BACKEND_API_KEY}"
          },
          {
            "name": "x-tenant-id",
            "value": "${TENANT_ID}"
          }
        ],
        "auth_connection": null
      },
      "response_timeout_secs": 10,
      "dynamic_variables": {
        "dynamic_variable_placeholders": {}
      },
      "assignments": [],
      "disable_interruptions": false,
      "force_pre_tool_speech": "Let me check your appointments.",
      "tool_call_sound": null,
      "tool_call_sound_behavior": "auto",
      "execution_mode": "immediate"
    },
    {
      "type": "webhook",
      "name": "get_patient_insurance",
      "description": "Get patient's insurance information and coverage details.",
      "api_schema": {
        "url": "https://cdapi.xaltrax.com/api/patients/{patient_id}/insurance",
        "method": "GET",
        "path_params_schema": [
          {
            "name": "patient_id",
            "type": "string",
            "required": true,
            "description": "Patient UUID"
          }
        ],
        "query_params_schema": [],
        "request_body_schema": null,
        "request_headers": [
          {
            "name": "Authorization",
            "value": "Bearer ${BACKEND_API_KEY}"
          },
          {
            "name": "x-tenant-id",
            "value": "${TENANT_ID}"
          }
        ],
        "auth_connection": null
      },
      "response_timeout_secs": 10,
      "dynamic_variables": {
        "dynamic_variable_placeholders": {}
      },
      "assignments": [],
      "disable_interruptions": false,
      "force_pre_tool_speech": "Let me look up your insurance information.",
      "tool_call_sound": null,
      "tool_call_sound_behavior": "auto",
      "execution_mode": "immediate"
    },
    {
      "type": "webhook",
      "name": "check_insurance_eligibility",
      "description": "Verify patient's insurance eligibility and coverage in real-time.",
      "api_schema": {
        "url": "https://cdapi.xaltrax.com/api/insurance/policies/{policy_id}/check-eligibility",
        "method": "POST",
        "path_params_schema": [
          {
            "name": "policy_id",
            "type": "string",
            "required": true,
            "description": "Insurance policy UUID"
          }
        ],
        "query_params_schema": [],
        "request_body_schema": null,
        "request_headers": [
          {
            "name": "Authorization",
            "value": "Bearer ${BACKEND_API_KEY}"
          },
          {
            "name": "x-tenant-id",
            "value": "${TENANT_ID}"
          }
        ],
        "auth_connection": null
      },
      "response_timeout_secs": 20,
      "dynamic_variables": {
        "dynamic_variable_placeholders": {}
      },
      "assignments": [],
      "disable_interruptions": true,
      "force_pre_tool_speech": "Let me verify your insurance coverage. This will take just a moment.",
      "tool_call_sound": null,
      "tool_call_sound_behavior": "auto",
      "execution_mode": "immediate"
    },
    {
      "type": "webhook",
      "name": "classify_intent",
      "description": "AI-powered intent classification to understand what the patient wants (appointment, question, emergency, etc.)",
      "api_schema": {
        "url": "https://ai-service-sparkling-brook-7912.fly.dev/intent/classify",
        "method": "POST",
        "path_params_schema": [],
        "query_params_schema": [],
        "request_body_schema": {
          "type": "object",
          "properties": {
            "tenant_id": {
              "type": "string",
              "description": "Tenant UUID"
            },
            "message": {
              "type": "string",
              "description": "Patient's message or utterance"
            },
            "context": {
              "type": "object",
              "description": "Optional conversation context"
            }
          },
          "required": ["tenant_id", "message"]
        },
        "request_headers": [
          {
            "name": "Content-Type",
            "value": "application/json"
          }
        ],
        "auth_connection": null
      },
      "response_timeout_secs": 10,
      "dynamic_variables": {
        "dynamic_variable_placeholders": {}
      },
      "assignments": [],
      "disable_interruptions": false,
      "force_pre_tool_speech": "auto",
      "tool_call_sound": null,
      "tool_call_sound_behavior": "auto",
      "execution_mode": "immediate"
    },
    {
      "type": "webhook",
      "name": "extract_entities",
      "description": "Extract structured information from patient's message (names, dates, times, procedure types)",
      "api_schema": {
        "url": "https://ai-service-sparkling-brook-7912.fly.dev/intent/extract-entities",
        "method": "POST",
        "path_params_schema": [],
        "query_params_schema": [],
        "request_body_schema": {
          "type": "object",
          "properties": {
            "tenant_id": {
              "type": "string",
              "description": "Tenant UUID"
            },
            "message": {
              "type": "string",
              "description": "Patient's message"
            },
            "entity_types": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Types of entities to extract (person, date, time, procedure, phone, email)"
            }
          },
          "required": ["tenant_id", "message"]
        },
        "request_headers": [
          {
            "name": "Content-Type",
            "value": "application/json"
          }
        ],
        "auth_connection": null
      },
      "response_timeout_secs": 10,
      "dynamic_variables": {
        "dynamic_variable_placeholders": {}
      },
      "assignments": [],
      "disable_interruptions": false,
      "force_pre_tool_speech": "auto",
      "tool_call_sound": null,
      "tool_call_sound_behavior": "auto",
      "execution_mode": "immediate"
    },
    {
      "type": "webhook",
      "name": "suggest_procedure_codes",
      "description": "Get CDT procedure code suggestions based on description (for treatment planning).",
      "api_schema": {
        "url": "https://ai-service-sparkling-brook-7912.fly.dev/coding/suggest",
        "method": "POST",
        "path_params_schema": [],
        "query_params_schema": [],
        "request_body_schema": {
          "type": "object",
          "properties": {
            "description": {
              "type": "string",
              "description": "Description of the procedure (e.g., 'cleaning', 'filling', 'crown')"
            },
            "category": {
              "type": "string",
              "description": "Optional category filter (preventive, restorative, endodontics, etc.)"
            }
          },
          "required": ["description"]
        },
        "request_headers": [
          {
            "name": "Content-Type",
            "value": "application/json"
          }
        ],
        "auth_connection": null
      },
      "response_timeout_secs": 10,
      "dynamic_variables": {
        "dynamic_variable_placeholders": {}
      },
      "assignments": [],
      "disable_interruptions": false,
      "force_pre_tool_speech": "auto",
      "tool_call_sound": null,
      "tool_call_sound_behavior": "auto",
      "execution_mode": "immediate"
    },
    {
      "type": "webhook",
      "name": "query_knowledge_base",
      "description": "Search practice knowledge base for answers to questions (office hours, services, pricing, policies).",
      "api_schema": {
        "url": "https://ai-service-sparkling-brook-7912.fly.dev/rag/query",
        "method": "POST",
        "path_params_schema": [],
        "query_params_schema": [],
        "request_body_schema": {
          "type": "object",
          "properties": {
            "tenant_id": {
              "type": "string",
              "description": "Tenant UUID"
            },
            "query": {
              "type": "string",
              "description": "Patient's question"
            },
            "top_k": {
              "type": "number",
              "description": "Number of results to return (default 5)"
            }
          },
          "required": ["tenant_id", "query"]
        },
        "request_headers": [
          {
            "name": "Content-Type",
            "value": "application/json"
          }
        ],
        "auth_connection": null
      },
      "response_timeout_secs": 15,
      "dynamic_variables": {
        "dynamic_variable_placeholders": {}
      },
      "assignments": [],
      "disable_interruptions": false,
      "force_pre_tool_speech": "Let me check that information for you.",
      "tool_call_sound": null,
      "tool_call_sound_behavior": "auto",
      "execution_mode": "immediate"
    }
  ],
  "conversation_config": {
    "system_prompt": "You are a friendly and professional AI receptionist for a dental practice. Your name is CrownDesk Assistant.\n\n## Your Capabilities:\n- Schedule, reschedule, and cancel appointments\n- Answer questions about office hours, location, and services\n- Look up patient information (after identity verification)\n- Check insurance information\n- Provide general information about dental procedures\n- Transfer to a human receptionist when needed\n\n## Important Rules:\n1. NEVER provide medical diagnoses or treatment recommendations\n2. NEVER guarantee insurance coverage amounts\n3. ALWAYS verify patient identity before disclosing personal information (ask for name and date of birth)\n4. If unsure or the patient requests, offer to transfer to a human receptionist\n5. Be concise - aim for responses under 2-3 sentences when possible\n6. Speak naturally and conversationally\n7. If there's an emergency, advise them to call 911 or go to the nearest emergency room\n\n## Conversation Flow:\n1. Greet warmly\n2. Ask how you can help\n3. Use webhooks to search patients, check availability, book appointments\n4. Confirm all details before finalizing\n5. Provide confirmation and next steps\n\n## Example Flows:\n\n### Booking Appointment:\n1. Ask patient name → use 'search_patients' webhook\n2. Verify DOB for security\n3. Ask preferred date/time\n4. Use 'get_available_slots' to check availability\n5. Offer available times\n6. Use 'create_appointment' to book\n7. Confirm details and send confirmation\n\n### Checking Existing Appointment:\n1. Ask patient name → use 'search_patients'\n2. Verify DOB\n3. Use 'get_patient_appointments' to retrieve appointments\n4. Share appointment details\n\n### Insurance Questions:\n1. Verify patient identity\n2. Use 'get_patient_insurance' webhook\n3. Share coverage info (but never guarantee amounts)\n4. Offer to check real-time eligibility if needed\n\n### General Questions:\n1. Use 'query_knowledge_base' for office info, services, policies\n2. Provide clear, helpful answers\n3. Offer to book appointment if relevant",
    "first_message": "Hello! Thank you for calling. This is the CrownDesk dental practice assistant. How can I help you today?",
    "voice_settings": {
      "recommended_voice": "Rachel",
      "stability": 0.5,
      "similarity_boost": 0.75,
      "style_exaggeration": 0.0
    }
  },
  "setup_instructions": {
    "step_1": "Go to https://elevenlabs.io/app/conversational-ai",
    "step_2": "Create new Conversational AI agent",
    "step_3": "Name it 'CrownDesk AI Receptionist'",
    "step_4": "In System Prompt, paste the conversation_config.system_prompt from this file",
    "step_5": "In First Message, paste the conversation_config.first_message",
    "step_6": "Select voice (recommended: Rachel)",
    "step_7": "Go to 'Tools' section and add each webhook from the webhooks array",
    "step_8": "For each webhook, copy the entire webhook object JSON",
    "step_9": "Replace ${BACKEND_API_KEY} with your actual backend API key",
    "step_10": "Replace ${TENANT_ID} with your tenant UUID",
    "step_11": "Test the agent using ElevenLabs test interface",
    "step_12": "Deploy and get phone number or embed on website"
  },
  "environment_variables_needed": {
    "BACKEND_API_KEY": "Get from backend .env or Vercel environment",
    "TENANT_ID": "Get from database tenants table or create via API",
    "ELEVENLABS_API_KEY": "Get from https://elevenlabs.io/app/settings/api-keys"
  },
  "testing": {
    "test_scenarios": [
      "Call and say: 'I need to book a cleaning appointment'",
      "Call and say: 'What are your office hours?'",
      "Call and say: 'I need to reschedule my appointment'",
      "Call and say: 'Do you accept Delta Dental insurance?'",
      "Call and say: 'This is an emergency, I have a toothache'"
    ],
    "expected_behaviors": [
      "Agent asks for patient name",
      "Agent searches for patient using webhook",
      "Agent verifies identity with DOB",
      "Agent checks available slots",
      "Agent books appointment and confirms details",
      "Agent queries knowledge base for office info",
      "Agent offers to transfer to human for emergencies"
    ]
  }
}
